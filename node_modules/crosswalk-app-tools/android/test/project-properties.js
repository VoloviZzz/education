// Copyright Â© 2014 Intel Corporation. All rights reserved.
// Use  of this  source  code is  governed by  an Apache v2
// license that can be found in the LICENSE-APACHE-V2 file.

var FS = require("fs");

var ShellJS = require("shelljs");

var Util = require("../../test-util/Util.js");

var ProjectProperties = require("../lib/ProjectProperties");
var TerminalOutput = require("../../src/TerminalOutput");

exports.tests = {

    androidLibraryReference1: function(test) {

        test.expect(2);
    
        var buffer = "" +
            "# This file is automatically generated by Android Tools.\n" +
            "# Do not modify this file -- YOUR CHANGES WILL BE ERASED!\n" +
            "#\n" +
            "# This file must be checked in Version Control Systems.\n" +
            "#\n" +
            "# To customize properties used by the Ant build system edit\n" +
            '# "ant.properties", and override values to adapt the script to your\n' +
            "# project structure.\n" +
            "#\n" +
            "# To enable ProGuard to shrink and obfuscate your code, uncomment this (available properties: sdk.dir, user.home):\n" +
            "#proguard.config=${sdk.dir}/tools/proguard/proguard-android.txt:proguard-project.txt\n" +
            "\n" +
            "# Extra libraries.\n" +
            "android.library.reference.1=xwalk_core_library\n" +
            "\n" +
            "# Project target.\n" +
            "target=android-23";
        
            var f1 = Util.createTmpFile();
            FS.writeFileSync(f1, buffer);

            var p = new ProjectProperties(f1, TerminalOutput.getInstance());
            test.equal(p.androidLibraryReference1, "xwalk_core_library");

            p.androidLibraryReference1 = "xwalk_shared_library";
            test.equal(p.androidLibraryReference1, "xwalk_shared_library");

            test.done();
    },
    target: function(test) {

        test.expect(2);
    
        var buffer = "" +
            "# This file is automatically generated by Android Tools.\n" +
            "# Do not modify this file -- YOUR CHANGES WILL BE ERASED!\n" +
            "#\n" +
            "# This file must be checked in Version Control Systems.\n" +
            "#\n" +
            "# To customize properties used by the Ant build system edit\n" +
            '# "ant.properties", and override values to adapt the script to your\n' +
            "# project structure.\n" +
            "#\n" +
            "# To enable ProGuard to shrink and obfuscate your code, uncomment this (available properties: sdk.dir, user.home):\n" +
            "#proguard.config=${sdk.dir}/tools/proguard/proguard-android.txt:proguard-project.txt\n" +
            "\n" +
            "# Extra libraries.\n" +
            "android.library.reference.1=xwalk_core_library\n" +
            "\n" +
            "# Project target.\n" +
            "target=android-23";
        
            var f1 = Util.createTmpFile();
            FS.writeFileSync(f1, buffer);

            var p = new ProjectProperties(f1, TerminalOutput.getInstance());
            test.equal(p.target, "android-23");

            p.target = "android-21";
            test.equal(p.target, "android-21");

            test.done();
    }
};